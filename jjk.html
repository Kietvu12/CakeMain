<%
Dim cn, cmd, rs
Dim strConnectString, strSQL
Dim uphone, upass

' Lấy thông tin đăng nhập từ form
uphone = Trim(Request.Form("uphone"))
upass = Trim(Request.Form("upass"))

If uphone <> "" And upass <> "" Then
  ' Thiết lập chuỗi kết nối đến SQL Server
  strConnectString = "Provider=SQLOLEDB;Data Source=DESKTOP-P7BQEGE;Initial Catalog=App;User ID=sa;Password=1;"
  
  ' Tạo đối tượng Connection và mở kết nối đến SQL Server
  Set cn = Server.CreateObject("ADODB.Connection")
  cn.Open strConnectString
  
  ' Tạo Command Object và thực thi truy vấn kiểm tra người dùng
  strSQL = "SELECT count(*) AS count FROM Acc WHERE uphone='" & uphone & "' AND upass='" & upass & "'"
  Set cmd = Server.CreateObject("ADODB.Command")
  cmd.ActiveConnection = cn
  cmd.CommandText = strSQL
  cmd.CommandType = adCmdText
  Set rs = cmd.Execute
  
  ' Kiểm tra kết quả truy vấn và đăng nhập thành công hoặc hiển thị thông báo lỗi cho người dùng
  If rs("count") > 0 Then
    Response.Redirect "index.asp" ' Chuyển hướng đến trang index.html khi đăng nhập thành công
  Else
    Response.Write "Số điện thoại hoặc mật khẩu không đúng." ' Hiển thị thông báo lỗi khi đăng nhập không thành công
  End If
  
  ' Giải phóng tài nguyên và đóng kết nối
  rs.Close
  Set rs = Nothing
  Set cmd = Nothing
  cn.Close
  Set cn = Nothing
End If
%>
<!DOCTYPE html>
<html>
<head>
  <title>Form đăng nhập</title>
</head>
<body>
  <h2>Đăng nhập</h2>
  <form method="post" action="index.asp">
    <label for="username">Tài khoản:</label>
    <input type="text" name="username" id="username"><br><br>
    <label for="password">Mật khẩu:</label>
    <input type="password" name="password" id="password"><br><br>
    <input type="submit" value="Đăng nhập">
  </form>
</body>
</html>
